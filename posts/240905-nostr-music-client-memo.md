---
title: "Nostrの音楽アプリをぼんやり構想してみる"
date: "2024-09-05"
---
Nostr のトラフィックと時間をともにできるアプリを作ったら面白いのではないかと思い、ぼんやり構想しています。

## Nostr ってなあに？

さて、まず読み方がわかりません。じつは、決まった読み方がないのです。ノストルでも、ノスターでも、お好きな読み方をあててみてください。

Nostr は、2022 年に fiatjaf 氏が提唱した、新しい分散型 SNS のプロトコルです。

- プロトコルとは、コンピュータが互いにコミュニケーションをとるための共通言語のようなものです。
- 分散型 SNS は、従来の SNS のように特定の会社が管理するのではなく、メールのように、様々なサーバーが独立して運営できる仕組みです。

Nostr では、 **「イベント」** と呼ばれるデータを使ってやり取りします。 例えば、あるユーザーが投稿すると、それはイベントとして Nostr のネットワークに流れます。

- イベントは **「リレー」** と呼ばれるサーバーに送られ、保存・配信されます。 リレーは世界中にたくさんあり、ユーザーは自分の好きなリレーを選んで接続できます。
- イベントには電子署名が施されます。 これにより、誰がイベントを作成したのか、内容が改竄されていないかを証明できます。

Nostr は、検閲に強く、ユーザーが自由に発信できる SNS を目指しています。まだ新しい技術ですが、すでにさまざまに応用されていて、掲示板、動画サイト、フリマアプリ、音楽配信サイトなどなど……たくさんのアプリが作られています。そして、それらのアプリすべてでひとつのアイデンティティを使うことができる所も大きな特徴です。今後の発展が期待されています。

## トラフィックと時間をともにする

念頭には Bloom と Project audio for Github があります。

Bloom は iOS 向けの作曲アプリです。シンプルな画面と感覚的な操作が特徴で、眺めているだけでとても心地よいです。

https://youtu.be/JEBofVEEeIE?si=hDaPs8CwQGvE67P-

Project audio for Github は Github 上で行われている作業を音楽に変換するアプリです。画面は Bloom によく似ていますが、操作できるスイッチなどはありません。偶然性の音楽とでも言うのでしょうか、Github のトラフィックがリアルタイムで音に変換されます。

https://youtu.be/N_-swndZ2Ys?si=Qor4q9QnMHt_qyl3

さて、なんとなく作りたいものが見えてきました。Nostr の特定のリレーサーバーからイベントをストリーミングして、いいかんじに音に変換するアプリをつくりたいです。

では、どうすればいいでしょうか。

## 楽しい音を奏でる

さて、義務教育時代の記憶を掘り起こしてみましょう。なんということでしょう、義務教育がなければ人を楽しませることもできないとは。

音の三要素というものがありましたね。

1. 音の高さ（周波数）
2. 音の大きさ（振幅）
3. 音の音色（波形）

イベントにはイベントのハッシュ値が含まれます。

ハッシュ値とは、そのデータから決定論的に算出される、逆算できない値のことです……とはいってもなんのこっちゃという感じですね。

割り算の余りを考えてみましょうか。42 割る 5 の余りはいくつでしょうか。2 ですね。

さて、2 という値だけ与えられたときに、もとの 42 という数字を予測することはできるでしょうか。割る 5 の余りを求めていることくらいは知っていることにしましょう。

5 で割ったとき 2 が余る数ですから、7 でしょうか。12 かもしれません。そうですね、ひとつに絞ることはできませんね。

このように、決定論的に計算をしたからといって、必ずもとの値が逆算できるとは限りません。こういった特徴を持っている数式が、一方向関数……特に暗号分野で用いられるのがハッシュ関数です。ハッシュ関数を使って求めた値がハッシュ値ですね。同じ数字を突っ込めば同じ値が出てくるので、例えば大きなデータがいくつかあったとき、あらかじめハッシュ値を算出しておけば、同じデータか違うデータか、かんたんに比較できます。

話がそれました。

というわけで、イベントに含まれるハッシュ値はイベント固有のものですから、これをもとにして音を決めればいいような気がします。

でも、音の三要素すべてをハッシュ値から決めてしまうのはいやです。それではランダムにピアノを叩くのと変わりません。私は音を楽しみたいのです。現代音楽みたいなよくわからないものを聴きたいわけではありません。あれは私には高尚すぎます。

制約が必要です。